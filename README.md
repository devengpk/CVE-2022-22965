# Spring4Shell-PoC Application

This application has been containerized and is susceptible to the Spring4Shell flaw (CVE-2022-22965). The war's complete Java source is available and changeable; it may be rebuilt each time the docker image is created. Tomcat will then start loading the created WAR. This application is a straightforward hello world that is based on [Spring tutorials](https://spring.io/guides/gs/handling-form-submission/). It has nothing exceptional to offer.


Details: https://www.lunasec.io/docs/blog/spring-rce-vulnerabilities

Problems with the POC? Visit the more actively updated LunaSec fork at https://github.com/lunasec-io/Spring4Shell-POC.

## Requirements

1. Docker
2. Python3 + requests library

## Instructions

1. Clone the repository
2. Build and run the container: `docker build . -t spring4shell && docker run -p 8090:8090 spring4shell`
3. App should now be available at http://localhost:8090/helloworld/greeting

![WebPage](screenshots/webpage.png?raw=true)

4. Run the exploit.py script:
 `python exploit.py --url "http://localhost:8090/helloworld/greeting"`

![WebPage](screenshots/runexploit_2.png?raw=true)

5. Visit the created webshell! Modify the `cmd` GET parameter for your commands. (`http://localhost:8090/shell.jsp` by default)

![WebPage](screenshots/RCE.png?raw=true)

Re-running the exploit will create an extra artifact file of {old_filename}_.jsp. 

PRs/DMs [@Rezn0k](https://twitter.com/rezn0k) are welcome for improvements!

## Credits

- [@reznok](https://twitter.com/esheavyind) for help on building a PoC. Check out their writeup at: https://github.com/reznok/Spring4Shell-POC
